{"version":3,"sources":["webpack:///./src/services/save-editor/behaviors.ts","webpack:///./src/logging/index.ts","webpack:///./src/state/utils.ts","webpack:///./src/services/save-editor/state.ts","webpack:///./src/services/save-editor/savefile/actions.ts","webpack:///./src/services/save-editor/selectors.ts","webpack:///./src/services/save-editor/duplicants/selectors.ts","webpack:///./src/state/saga.ts","webpack:///./src/services/save-editor/duplicants/actions.ts","webpack:///./src/action-utils.ts","webpack:///./src/services/save-editor/savefile/selectors.ts","webpack:///./src/services/save-editor/savefile/save-loader.worker.ts","webpack:///./src/services/save-editor/savefile/saga.ts","webpack:///./src/services/save-editor/saga.ts","webpack:///./src/services/save-editor/duplicants/reducer.ts","webpack:///./src/services/save-editor/savefile/reducer.ts","webpack:///./src/services/save-editor/reducer.ts","webpack:///./src/state/reducer.ts","webpack:///./src/state/store.ts","webpack:///./src/pages/SaveEditor/pages/404/component.tsx","webpack:///./src/pages/SaveEditor/pages/404/index.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/pages/Skills/component.tsx","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/pages/Skills/index.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/pages/Appearance/component.tsx","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/pages/Appearance/index.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/dispatch.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/selectors.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/component.tsx","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantEditor/index.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantsList/selectors.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantPortrait/selectors.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantPortrait/component.tsx","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantPortrait/index.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantsList/component.tsx","webpack:///./src/pages/SaveEditor/pages/Duplicants/components/DuplicantsList/index.ts","webpack:///./src/pages/SaveEditor/pages/Duplicants/component.tsx","webpack:///./src/pages/SaveEditor/pages/Duplicants/index.ts","webpack:///./src/components/ActiveAwareLink/component.tsx","webpack:///./src/components/ActiveAwareLink/index.ts","webpack:///./src/pages/SaveEditor/component.tsx","webpack:///./src/pages/SaveEditor/index.ts","webpack:///./src/pages/LoadingSaveFile/component.tsx","webpack:///./src/pages/LoadingSaveFile/index.ts","webpack:///./src/pages/NoSaveLoaded/dispatch.ts","webpack:///./src/pages/NoSaveLoaded/selectors.ts","webpack:///./src/pages/NoSaveLoaded/component.tsx","webpack:///./src/pages/NoSaveLoaded/index.ts","webpack:///./src/pages/error/dispatch.ts","webpack:///./src/pages/error/selectors.ts","webpack:///./src/pages/error/component.tsx","webpack:///./src/pages/error/index.ts","webpack:///./src/components/App/dispatch.ts","webpack:///./src/components/App/selectors.ts","webpack:///./src/components/App/component.tsx","webpack:///./src/components/App/index.ts","webpack:///./src/app.tsx","webpack:///./src/css/root.scss","webpack:///./src/css/root.scss?3097","webpack:///./src/css/index.ts","webpack:///./src/index.tsx"],"names":["getBehavior","gameObject","name","behaviors","find","x","exports","KPrefabIDBehavior","MinionIdentityBehavior","MinionResumeBehavior","AIAttributeLevelsBehavior","AITraitsBehavior","AIEffectsBehavior","HealthBehavior","failureType","ACTION_INVALID","SAVEFILE_CORRUPT","STATE_CORRUPT","MISSING_BEHAVIOR","warning","message","console","warn","error","Object","freeze","seal","FAILURE_TYPE","reselect_1","__webpack_require__","createStructuredSelector","selectors","selectorCreator","defaultSaveEditorState","fileName","isLoading","isSaving","loadError","saveGame","normalizedIDs","saveEditorStateKey","action_utils_1","ACTION_SAVEFILE_LOAD","loadSavefile","createAction","ACTION_SAVEFILE_SAVE","saveSavefile","ACTION_SAVEFILE_SAVE_START","saveSavefileStarted","ACTION_SAVEFILE_SAVE_END","saveSavefileEnded","ACTION_SAVEFILE_RECEIVED","savefileReceived","saveEditor","state","createSelector","makeGetGameObjectsByType","type","gameObjects","makeGetBehaviorByName","gameObjectSelector","behaviorName","body","selectors_1","behaviors_1","makeGetDuplicantByID","propKey","duplicantsMap","_","props","id","prototype","hasOwnProperty","call","duplicants","duplicantsIDs","ids","duplicant","idBehavior","parsedData","push","InstanceID","dups","redux_saga_1","__importDefault","effects_1","saga_1","sagaMiddleware","default","runSaga","run","fork","ACTION_DUPLICANT_RENAME","renameDuplicant","redux_actions_1","payloadCreator","isSaveChosen","Boolean","saveFileName","isSaveLoaded","isSaveLoading","isSaveSaving","isSaveEnabled","module","Worker","p","file_saver_1","actions_1","save_loader_worker_1","logging_1","worker","loadSaveFile","action","file","payload","reader","FileReader","loadGamePromise","Promise","accept","reject","onload","result","onerror","readAsArrayBuffer","then","buffer","e","onmessage","data","cmd","command","postMessage","put","err","log","select","saveDataPromise","save","saveData","blob","Blob","saveAs","handleSaveOrLoad","take","default_1","state_1","duplicantsReducer","_action","prefabID","location","index","identityIndex","findIndex","identity","assign","[object Object]","slice","saveFileReducer","prefabType","prefabs","i","length","isNaN","reducer_1","reducer_2","reducers","saveEditorReducer","reducer","redux_1","combineReducers","middleware","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","React","__importStar","core_1","DuplicantsPage","Component","createElement","NonIdealState","className","visual","component_1","SkillsPage","DuplicantGeneralPage","super","this","editingName","nextProps","mapDispatchToProps","dispatch","bindActionCreators","utils_1","selectors_2","mapStateToProps","identityBehavior","react_redux_1","core_decorators_1","dispatch_1","Appearance_1","Skills_1","DuplicantEditor","rename","EditableText","value","onChange","_onNameChange","onConfirm","_onRename","Tabs","Tab","title","panel","str","setState","s","duplicantID","__decorate","autobind","connect","resumeBehavior","DuplicantPortrait","role","outerClassName","currentRole","Card","interactive","onClick","_onClick","DuplicantPortrait_1","DuplicantsList","selectedDuplicantID","elements","map","key","_onDuplicantClick","onDuplicantClick","DuplicantsList_1","DuplicantEditor_1","content","_onDuplicantSelected","react_router_1","react_router_dom_1","ActiveAwareLink","_a","to","children","exact","staticContext","other","__rest","pathName","pathname","match","startsWith","toString","Link","event","preventDefault","withRouter","ActiveAwareLink_1","Duplicants_1","_404_1","SaveEditorPageComponent","Switch","Redirect","from","Route","path","component","LoadingSaveFilePageComponent","Text","Spinner","large","saveDescription","savePath","NoSaveLoadedPageComponent","_input","Button","intent","Intent","PRIMARY","_onLoadClick","description","ref","el","style","display","_onLoadFile","click","change","files","target","ErrorPageComponent","Error","stack","error_1","NoSaveLoaded_1","LoadingSaveFile_1","SaveEditor_1","AppComponent","rootComponent","requireExactPath","Navbar","NavbarGroup","NavbarHeading","ellipsize","align","Alignment","RIGHT","icon","disabled","_onSaveClick","Dialog","isOpen","isCloseButtonShown","react_hot_loader_1","App_1","hot","options","hmr","transform","insertInto","undefined","locals","ReactDOM","app_1","store_1","rootEl","document","getElementById","render","Provider","HashRouter"],"mappings":"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","file":"client.c92c71ea4f0390d3c71a.bundle.js","sourcesContent":["\r\nimport {\r\n    GameObject,\r\n    GameObjectBehavior\r\n} from \"oni-save-parser\";\r\n\r\nexport type BehaviorName<T extends GameObjectBehavior> = string & { __behaviorTypeMetadata?: T & never};\r\n\r\n\r\nexport const KPrefabIDBehavior: BehaviorName<KPrefabIDBehavior> = \"KPrefabID\";\r\nexport interface KPrefabIDBehavior extends GameObjectBehavior {\r\n    name: \"KPrefabID\";\r\n    parsedData: {\r\n        InstanceID: number;\r\n    };\r\n}\r\n\r\n\r\nexport const MinionIdentityBehavior: BehaviorName<MinionIdentityBehavior> = \"MinionIdentity\";\r\nexport interface MinionIdentityBehavior extends GameObjectBehavior {\r\n    name: \"MinionIdentity\";\r\n    parsedData: {\r\n        arrivalTime: number;\r\n        bodyShape: any;\r\n        gender: \"MALE\" | \"FEMALE\";\r\n        genderStringKey: \"MALE\" | \"FEMALE\";\r\n        name: string;\r\n        nameStringKey: string;\r\n    };\r\n}\r\n\r\n\r\nexport const MinionResumeBehavior: BehaviorName<MinionResumeBehavior> = \"MinionResume\";\r\nexport interface MinionResumeBehavior extends GameObjectBehavior {\r\n    name: \"MinionResume\";\r\n    parsedData: {\r\n        ExperienceByRoleID: [string, number][];\r\n        MasteryByRoleID: [string, boolean][];\r\n        AptitudeByRoleGroup: [{hash: number}, number][];\r\n        currentRole: string;\r\n        targetRole: string;\r\n    };\r\n}\r\n\r\n\r\nexport const AIAttributeLevelsBehavior: BehaviorName<AIAttributeLevelsBehavior> = \"Klei.AI.AttributeLevels\";\r\nexport interface AIAttributeLevelsBehavior extends GameObjectBehavior {\r\n    name: \"Klei.AI.AttributeLevels\";\r\n    parsedData: {\r\n        saveLoadLevels: AttributeSaveLoadLevel[];\r\n    };\r\n}\r\nexport interface AttributeSaveLoadLevel {\r\n    attributeId: string;\r\n    experience: number;\r\n    level: number;\r\n}\r\n\r\n\r\nexport const AITraitsBehavior: BehaviorName<AITraitsBehavior> = \"Klei.AI.Traits\";\r\nexport interface AITraitsBehavior extends GameObjectBehavior {\r\n    name: \"Klei.AI.Traits\";\r\n    parsedData: {\r\n        TraitIds: string[];\r\n    };\r\n}\r\n\r\n\r\nexport const AIEffectsBehavior: BehaviorName<AIEffectsBehavior> = \"Klei.AI.Effects\";\r\nexport interface AIEffectsBehavior extends GameObjectBehavior {\r\n    name: \"Klei.AI.Effects\";\r\n    parsedData: {\r\n        saveLoadEffects: EffectInstance[]\r\n    }\r\n}\r\nexport interface EffectInstance {\r\n    id: string;\r\n    timeRemaining: number;\r\n}\r\n\r\n\r\nexport const HealthBehavior: BehaviorName<HealthBehavior> = \"Health\";\r\nexport interface HealthBehavior extends GameObjectBehavior {\r\n    name: \"Health\";\r\n    parsedData: {\r\n        CanBeIncapacitated: boolean;\r\n        State: number;\r\n    };\r\n}\r\n\r\n\r\nexport type KnownBehavior = \r\n    KPrefabIDBehavior\r\n    | MinionIdentityBehavior\r\n    | MinionResumeBehavior\r\n    | AIAttributeLevelsBehavior\r\n    | AITraitsBehavior\r\n    | HealthBehavior;\r\nexport type KnownBehaviorName = KnownBehavior[\"name\"]\r\n\r\nexport function getBehavior<T extends GameObjectBehavior>(gameObject: GameObject, name: BehaviorName<T>): T | undefined {\r\n    return gameObject.behaviors.find(x => x.name === name) as T | undefined;\r\n}","\r\nconst failureType = {\r\n    ACTION_INVALID: \"action-invalid\" as \"action-invalid\",\r\n    SAVEFILE_CORRUPT: \"savefile-corrupt\" as \"savefile-corrupt\",\r\n    STATE_CORRUPT: \"state-corrupt\" as \"state-corrupt\",\r\n    MISSING_BEHAVIOR: \"missing-behavior\" as \"missing-behavior\"\r\n};\r\nObject.freeze(failureType);\r\nObject.seal(failureType);\r\n\r\nexport type FailureType = (typeof failureType)[keyof typeof failureType];\r\nexport const FAILURE_TYPE: Readonly<typeof failureType> = failureType;\r\n\r\n\r\nexport function warning(message: string, failureType?: FailureType) {\r\n    // TODO: Log to user console.\r\n    console.warn(`(${failureType}):`, message);\r\n}\r\n\r\nexport function error(message: string, failureType?: FailureType) {\r\n    // TODO: Log to user console.\r\n    console.error(`(${failureType}):`, message);\r\n}","\r\nimport { Dispatch as TypedDispatch } from \"react-redux\";\r\n\r\nimport { Selector, createStructuredSelector as createSS, createSelector, ParametricSelector } from \"reselect\";\r\n\r\nimport { AppState } from \"./state\";\r\n\r\nexport type Dispatch = TypedDispatch<AppState>;\r\n\r\nexport function createStructuredSelector<StateProps>(selectors: {[K in keyof StateProps]: Selector<AppState, StateProps[K]>}, selectorCreator?: typeof createSelector): Selector<AppState, StateProps>;\r\nexport function createStructuredSelector<Props, StateProps>(selectors: {[K in keyof StateProps]: ParametricSelector<AppState, Props, StateProps[K]>}, selectorCreator?: typeof createSelector): ParametricSelector<AppState, Props, StateProps>;\r\nexport function createStructuredSelector<StateProps>(selectors: any, selectorCreator?: typeof createSelector): Selector<AppState, StateProps> {\r\n    return createSS(selectors, selectorCreator);\r\n}\r\n","\r\nimport { SaveGame } from \"oni-save-parser\";\r\n\r\nexport interface SaveEditorState {\r\n    fileName: string | null;\r\n    isLoading: boolean;\r\n    isSaving: boolean;\r\n    loadError: Error | null;\r\n    saveGame: SaveGame | null;\r\n\r\n    // A sparse array keyed by prefab ID, specifying the type and index (in the typed game object array) of the game object.\r\n    normalizedIDs: NormalizedID[]\r\n}\r\nexport interface NormalizedID {\r\n    type: string;\r\n    index: number;\r\n}\r\n\r\n\r\nexport const defaultSaveEditorState: SaveEditorState = {\r\n    fileName: null,\r\n    isLoading: false,\r\n    isSaving: false,\r\n    loadError: null,\r\n    saveGame: null,\r\n\r\n    normalizedIDs: []\r\n};\r\n\r\nexport const saveEditorStateKey = \"saveEditor\";\r\n","\r\nimport { SaveGame } from \"oni-save-parser\";\r\n\r\nimport { createAction } from \"../../../action-utils\";\r\n\r\nexport const ACTION_SAVEFILE_LOAD = \"@save-editor/savefile/load\";\r\nexport const loadSavefile = createAction(ACTION_SAVEFILE_LOAD, (x: {file: File}) => x);\r\nexport type LoadSavefileAction = ReturnType<typeof loadSavefile>;\r\n\r\nexport const ACTION_SAVEFILE_SAVE = \"@save-editor/savefile/save\";\r\nexport const saveSavefile = createAction(ACTION_SAVEFILE_SAVE, (x: {fileName?: string}) => x);\r\nexport type SaveSavefileAction = ReturnType<typeof saveSavefile>;\r\n\r\nexport const ACTION_SAVEFILE_SAVE_START = \"@save-editor/savefile/save/start\";\r\nexport const saveSavefileStarted = createAction(ACTION_SAVEFILE_SAVE_START, () => {});\r\nexport type SaveSavefileStartedAction = ReturnType<typeof saveSavefileStarted>;\r\n\r\nexport const ACTION_SAVEFILE_SAVE_END = \"@save-editor/savefile/save/end\";\r\nexport const saveSavefileEnded = createAction(ACTION_SAVEFILE_SAVE_END, () => {});\r\nexport type SaveSavefileEndedAction = ReturnType<typeof saveSavefileEnded>;\r\n\r\n\r\nexport const ACTION_SAVEFILE_RECEIVED = \"@save-editor/savefile/received\";\r\nexport const savefileReceived = createAction(ACTION_SAVEFILE_RECEIVED, (x: {saveGame: SaveGame}) => x);\r\nexport type SavefileReceivedAction = ReturnType<typeof savefileReceived>;\r\n\r\nexport type SavefileActions = LoadSavefileAction | SaveSavefileAction | SaveSavefileStartedAction | SaveSavefileEndedAction | SavefileReceivedAction;\r\n","\r\nimport { Selector, createSelector, ParametricSelector } from \"reselect\";\r\nimport { GameObject, GameObjectBehavior } from \"oni-save-parser\";\r\n\r\nimport { AppState } from \"../../state\";\r\n\r\nimport { BehaviorName, getBehavior, MinionIdentityBehavior, KPrefabIDBehavior } from \"./behaviors\";\r\n\r\n\r\nexport const saveEditor = (state: AppState) => state.saveEditor;\r\n\r\n// TODO: Lots of data can be precalculated here, but then we have to update\r\n//  it when the game objects are modified.\r\n// May want to investigate normalizing the save file then de-normalizing it\r\n//  to save.  This is blocked currently by needing a very deeply nested value (KPrefabID) as the\r\n//  ID to the game object.\r\n\r\nconst saveGame = createSelector(saveEditor, saveEditor => saveEditor.saveGame);\r\n\r\nexport const gameObjects = createSelector(saveGame, saveGame => saveGame ? saveGame.body.gameObjects : null);\r\n\r\nexport function makeGetGameObjectsByType(type: string): Selector<AppState, GameObject[]> {\r\n    return createSelector(\r\n        gameObjects,\r\n        gameObjects => gameObjects ? gameObjects[type] || [] : []\r\n    );\r\n}\r\n\r\n// We can handle parametric or non-parametric input selectors.  We do not use the parameter, but createSelector will pass the params as required.\r\nexport function makeGetBehaviorByName<T extends GameObjectBehavior>(gameObjectSelector: Selector<AppState, GameObject | null>, behaviorName: BehaviorName<T>): Selector<AppState, T | null>;\r\nexport function makeGetBehaviorByName<Props, T extends GameObjectBehavior>(gameObjectSelector: ParametricSelector<AppState, Props, GameObject | null>, behaviorName: BehaviorName<T>): ParametricSelector<AppState, Props, T | null>;\r\nexport function makeGetBehaviorByName<T extends GameObjectBehavior>(\r\n    gameObjectSelector: (Selector<AppState, GameObject | null> | ParametricSelector<AppState, any, GameObject | null>),\r\n    behaviorName: BehaviorName<T>\r\n): ParametricSelector<AppState, any, T | null> {\r\n    return createSelector(\r\n        gameObjectSelector,\r\n        (gameObject) => (gameObject && gameObject.behaviors.find(x => x.name === behaviorName) as T) || null\r\n    );\r\n}","\r\nimport { GameObject } from \"oni-save-parser\";\r\nimport { createSelector, ParametricSelector } from \"reselect\";\r\n\r\nimport { makeGetGameObjectsByType } from \"../selectors\";\r\nimport { KPrefabIDBehavior, getBehavior } from \"../behaviors\";\r\nimport { AppState } from \"../../../state\";\r\n\r\n\r\nexport const duplicants = makeGetGameObjectsByType(\"Minion\");\r\nexport const duplicantsIDs = createSelector(\r\n    duplicants,\r\n    duplicants => {\r\n        const ids: number[] = [];\r\n        for (let duplicant of duplicants) {\r\n            const idBehavior = getBehavior(duplicant, KPrefabIDBehavior);\r\n            if (idBehavior && idBehavior.parsedData) {\r\n                ids.push(idBehavior.parsedData.InstanceID);\r\n            }\r\n        }\r\n        return ids;\r\n    }\r\n);\r\n\r\nexport const duplicantsMap = createSelector(\r\n    duplicants,\r\n    duplicants => {\r\n        const dups: {[key: number]: GameObject} = {};\r\n        for (let duplicant of duplicants) {\r\n            const idBehavior = getBehavior(duplicant, KPrefabIDBehavior);\r\n            if (idBehavior && idBehavior.parsedData) {\r\n                dups[idBehavior.parsedData.InstanceID] = duplicant;\r\n            }\r\n        }\r\n        return dups;\r\n    }\r\n)\r\n\r\nexport function makeGetDuplicantByID<Props>(propKey: keyof Props): ParametricSelector<AppState, Props, GameObject | null> {\r\n    return createSelector(\r\n        duplicantsMap,\r\n        // We know the type of Props, but we need to have TS validate it as a string somehow...\r\n        (_: AppState, props: any) => props[propKey],\r\n        (duplicantsMap, id) => {\r\n            if (!Object.prototype.hasOwnProperty.call(duplicantsMap, id)) {\r\n                return null;\r\n            }\r\n            return duplicantsMap[id];\r\n        }\r\n    );\r\n};","\r\nimport createSagaMiddleware from \"redux-saga\";\r\nimport { fork } from \"redux-saga/effects\"\r\n\r\nimport saveEditorSaga from \"../services/save-editor/saga\";\r\n\r\nconst sagaMiddleware = createSagaMiddleware();\r\nexport default sagaMiddleware;\r\n\r\nexport function runSaga() {\r\n    sagaMiddleware.run(function*() {\r\n        yield fork(saveEditorSaga);\r\n    });\r\n}","\r\nimport { createAction } from \"../../../action-utils\";\r\n\r\nexport const ACTION_DUPLICANT_RENAME = \"@save-editor/duplicants/rename\";\r\nexport const renameDuplicant = createAction(ACTION_DUPLICANT_RENAME, (x: {prefabID: number, name: string}) => x);\r\nexport type RenameDuplicantAction = ReturnType<typeof renameDuplicant>;\r\n\r\nexport type DuplicantActions = RenameDuplicantAction;\r\n","\r\nimport { createAction as createReduxAction } from \"redux-actions\";\r\n\r\n// We can do this better than the Action type of redux-actions:\r\n//  - Create a discriminated union on explicit 'type' types for use in reducers.\r\n//  - inferr the action typedef and payload shape using TS 2.8's ReturnType / infer keyword.\r\n// This gets us very close, but hides the parameter names for our payload creator.\r\n//  To get around this, we just use one argument that contains the payload.  This\r\n//  lets us expose the names as well as the types, at the cost of having to pass in data\r\n//  in object form.\r\n\r\n\r\nexport interface NamedAction<TName extends string, TPayload> {\r\n    type: TName;\r\n    payload: TPayload;\r\n}\r\n\r\n\r\nexport function createAction<TName extends string, TPayload, T1>(name: TName, payloadCreator: (arg1: T1) => TPayload): (arg1: T1) => NamedAction<TName, TPayload>;\r\nexport function createAction<TName extends string, TPayload>(name: TName, payloadCreator: (...args: any[]) => TPayload): (...args: any[]) => NamedAction<TName, TPayload> {\r\n    return createReduxAction(name, payloadCreator) as any;\r\n}\r\n","\r\nimport { createSelector } from \"reselect\";\r\n\r\nimport { saveEditor } from \"../selectors\";\r\n\r\nexport const isSaveChosen = createSelector(saveEditor, saveEditor => Boolean(saveEditor.fileName != null));\r\nexport const saveFileName = createSelector(saveEditor, saveEditor => saveEditor.fileName);\r\nexport const isSaveLoaded = createSelector(saveEditor, saveEditor => Boolean(saveEditor.fileName != null && !saveEditor.isLoading));\r\nexport const isSaveLoading = createSelector(saveEditor, saveEditor => saveEditor.isLoading);\r\nexport const isSaveSaving = createSelector(saveEditor, saveEditor => saveEditor.isSaving);\r\nexport const isSaveEnabled = createSelector(saveEditor, saveEditor => Boolean(saveEditor.fileName && saveEditor.isLoading == false));\r\nexport const loadError = createSelector(saveEditor, saveEditor => saveEditor.loadError);\r\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"8081acf5c0f20743699f.worker.js\");\n};","\r\nimport { take, fork, call, put, select } from \"redux-saga/effects\";\r\nimport { saveAs } from \"file-saver\";\r\nimport { SaveGame } from \"oni-save-parser\";\r\n\r\n\r\nimport {\r\n    ACTION_SAVEFILE_LOAD,\r\n    ACTION_SAVEFILE_SAVE,\r\n    LoadSavefileAction,\r\n    SaveSavefileAction,\r\n    savefileReceived,\r\n    saveSavefileStarted,\r\n    saveSavefileEnded\r\n} from \"./actions\";\r\n\r\nimport SaveLoadWorker from \"worker-loader!./save-loader.worker\";\r\nimport { LoadCommandData, SaveCommandData } from \"./save-loader.worker\";\r\nimport { Action } from \"redux\";\r\nimport { AppState } from \"../../../state\";\r\nimport { error } from \"../../../logging\";\r\n\r\n\r\nconst worker = new SaveLoadWorker();\r\n\r\nfunction* loadSaveFile(action: LoadSavefileAction) {\r\n    const {\r\n        file\r\n    } = action.payload;\r\n\r\n    const reader = new FileReader();\r\n    const loadGamePromise = new Promise<File>((accept, reject) => {\r\n        reader.onload = () => {\r\n            accept(reader.result);\r\n        };\r\n        reader.onerror = () => {\r\n            reject(reader.error);\r\n        };\r\n        reader.readAsArrayBuffer(file);\r\n    }).then(buffer => {\r\n        return new Promise((accept, reject) => {\r\n            worker.onerror = (e: ErrorEvent) => { reject(e.error) };\r\n            worker.onmessage = (e: MessageEvent) => {\r\n                const {\r\n                    saveGame,\r\n                    error\r\n                } = e.data;\r\n                if (error) reject(error);\r\n                else accept(saveGame);\r\n            };\r\n\r\n            const cmd: LoadCommandData = {\r\n                command: \"load\",\r\n                buffer: reader.result\r\n            };\r\n            worker.postMessage(cmd);\r\n        });\r\n    });\r\n\r\n    try {\r\n        const saveGame: SaveGame = yield call(() => loadGamePromise);\r\n        yield put(savefileReceived({ saveGame }));\r\n    }\r\n    catch (err) {\r\n        // TODO: either send with savefileReceived error key, or make a new action for this.\r\n        console.log(err);\r\n    }\r\n}\r\n\r\nfunction* saveSavefile(action: SaveSavefileAction) {\r\n    const {\r\n        fileName\r\n    } = action.payload;\r\n\r\n    const state: AppState = yield select();\r\n\r\n    const saveGame = state.saveEditor.saveGame;\r\n    if (!saveGame) {\r\n        return;\r\n    }\r\n\r\n    yield put(saveSavefileStarted({}));\r\n\r\n    try {\r\n        const saveDataPromise = new Promise<ArrayBuffer>((accept, reject) => {\r\n            worker.onerror = (e: ErrorEvent) => { reject(e.error) };\r\n            worker.onmessage = (e: MessageEvent) => {\r\n                const {\r\n                    buffer,\r\n                    error\r\n                } = e.data;\r\n                if (error) reject(error);\r\n                else accept(buffer);\r\n            };\r\n\r\n            const cmd: SaveCommandData = {\r\n                command: \"save\",\r\n                save: saveGame\r\n            };\r\n            worker.postMessage(cmd);\r\n        });\r\n\r\n        const saveData: ArrayBuffer = yield call(() => saveDataPromise);\r\n        const blob = new Blob([saveData]);\r\n\r\n        saveAs(blob, fileName || state.saveEditor.fileName || \"my-file.sav\");\r\n    }\r\n    catch (e) {\r\n        error(\"Failed to save file: \" + e.message);\r\n    }\r\n\r\n    yield put(saveSavefileEnded({}));\r\n}\r\n\r\nfunction* handleSaveOrLoad() {\r\n    // Take a save or load, then block until we complete.\r\n    //  This will effectively ignore save/load calls happening while we are working.\r\n    while (true) {\r\n        const action: LoadSavefileAction | SaveSavefileAction = yield take([ACTION_SAVEFILE_LOAD, ACTION_SAVEFILE_SAVE]);\r\n        switch (action.type) {\r\n            case ACTION_SAVEFILE_LOAD:\r\n                yield call<LoadSavefileAction>(loadSaveFile, action);\r\n                continue;\r\n            case ACTION_SAVEFILE_SAVE:\r\n                yield call<SaveSavefileAction>(saveSavefile, action);\r\n                continue;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport default function* () {\r\n    yield fork(handleSaveOrLoad);\r\n}\r\n","\r\nimport { fork } from \"redux-saga/effects\";\r\n\r\nimport saveFileSaga from \"./savefile/saga\";\r\n\r\nexport default function* () {\r\n    yield fork(saveFileSaga);\r\n}","\r\nimport { AnyAction } from \"redux\";\r\n\r\nimport { error, FAILURE_TYPE } from \"../../../logging\";\r\n\r\nimport { SaveEditorState, defaultSaveEditorState } from \"../state\";\r\n\r\nimport {\r\n    ACTION_DUPLICANT_RENAME,\r\n    DuplicantActions\r\n} from \"./actions\";\r\nimport { MinionIdentityBehavior } from \"../behaviors\";\r\n\r\nexport default function duplicantsReducer(state: SaveEditorState = defaultSaveEditorState, _action: AnyAction) {\r\n    const action = _action as DuplicantActions;\r\n    switch(action.type) {\r\n        case ACTION_DUPLICANT_RENAME: {\r\n            const {\r\n                prefabID,\r\n                name\r\n            } = action.payload;\r\n\r\n            const saveGame = state.saveGame;\r\n            if (!saveGame) {\r\n                error(`Action \"${action.type}\" called before a save game is available.`, FAILURE_TYPE.ACTION_INVALID);\r\n                return state;\r\n            }\r\n\r\n            const location = state.normalizedIDs[prefabID];\r\n            if (!location) {\r\n                error(`Action \"${action.type}\" requested prefabID ${prefabID}, which is not in the normalized ID table.`, FAILURE_TYPE.ACTION_INVALID);\r\n                return state;\r\n            }\r\n\r\n            const {\r\n                type,\r\n                index\r\n            } = location;\r\n\r\n            if (type !== \"Minion\") {\r\n                error(`Action \"${action.type}\" requested prefabID ${prefabID}, which is not a duplicant.`, FAILURE_TYPE.ACTION_INVALID);\r\n                return state;\r\n            }\r\n\r\n            const gameObject = saveGame.body.gameObjects[type][index];\r\n            if (!gameObject) {\r\n                error(`Action \"${action.type}\" prefabID ${prefabID} mapped to prefab \"${type}\":${index}, which does not exist.`, FAILURE_TYPE.STATE_CORRUPT);\r\n                return state;\r\n            }\r\n\r\n            const identityIndex = gameObject.behaviors.findIndex(x => x.name === MinionIdentityBehavior);\r\n            if (identityIndex === -1) {\r\n                error(`Action \"${action.type}\" prefabID ${prefabID} prefab \"${type}\":${index} does not have behavior \"${MinionIdentityBehavior}\".`, FAILURE_TYPE.SAVEFILE_CORRUPT);\r\n                return state;\r\n            }\r\n            const identity = gameObject.behaviors[identityIndex];\r\n\r\n            // Aarrrgggh, normalize!\r\n            return {\r\n                ...state,\r\n                saveGame: {\r\n                    ...saveGame,\r\n                    body: {\r\n                        ...saveGame.body,\r\n                        gameObjects: {\r\n                            ...saveGame.body.gameObjects,\r\n                            [type]: [\r\n                                ...saveGame.body.gameObjects[type].slice(0, index),\r\n                                {\r\n                                    ...gameObject,\r\n                                    behaviors: [\r\n                                        ...gameObject.behaviors.slice(0, identityIndex),\r\n                                        {\r\n                                            ...identity,\r\n                                            parsedData: {\r\n                                                ...identity.parsedData,\r\n                                                name\r\n                                            }\r\n                                        },\r\n                                        ...gameObject.behaviors.slice(identityIndex + 1)\r\n\r\n                                    ]\r\n                                },\r\n                                ...saveGame.body.gameObjects[type].slice(index + 1)\r\n                            ]\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}","\r\nimport { AnyAction } from \"redux\";\r\nimport uuidV4 from \"uuid/v4\";\r\n\r\nimport { SaveEditorState, defaultSaveEditorState, NormalizedID } from \"../state\";\r\n\r\nimport {\r\n    SavefileActions,\r\n    ACTION_SAVEFILE_LOAD,\r\n    ACTION_SAVEFILE_RECEIVED,\r\n    ACTION_SAVEFILE_SAVE_START,\r\n    ACTION_SAVEFILE_SAVE_END\r\n} from \"./actions\";\r\n\r\nimport { getBehavior, KPrefabIDBehavior } from \"./../behaviors\";\r\nimport { warning, error, FAILURE_TYPE } from \"../../../logging\";\r\n\r\n\r\nexport default function saveFileReducer(state: SaveEditorState = defaultSaveEditorState, _action: AnyAction): SaveEditorState {\r\n    const action = _action as SavefileActions;\r\n    switch (action.type) {\r\n        case ACTION_SAVEFILE_LOAD: {\r\n            const {\r\n                file\r\n            } = action.payload;\r\n\r\n            // Also ignored in saga.\r\n            if (state.isSaving) return state;\r\n\r\n            return {\r\n                ...defaultSaveEditorState,\r\n                fileName: file.name,\r\n                isLoading: true\r\n            }\r\n        }\r\n        case ACTION_SAVEFILE_RECEIVED: {\r\n            const {\r\n                saveGame\r\n            } = action.payload;\r\n\r\n            // Build a normalization cache of game object PrefabIDs to the\r\n            //  type and array index of the object.\r\n            // We can save a lot of work by precaching this information,\r\n            //  and we (currently) do not create / delete / reorder any objects.\r\n            const normalizedIDs: NormalizedID[] = [];\r\n            for (let prefabType in saveGame.body.gameObjects) {\r\n                const prefabs = saveGame.body.gameObjects[prefabType];\r\n                for (let i = 0; i < prefabs.length; i++) {\r\n                    const idBehavior = getBehavior(prefabs[i], KPrefabIDBehavior);\r\n                    if (!idBehavior) {\r\n                        warning(`GameObject at \"${prefabs}\":${i} has no behavior \"${KPrefabIDBehavior}\".`, FAILURE_TYPE.MISSING_BEHAVIOR);\r\n                        continue;\r\n                    }\r\n                    if (!idBehavior.parsedData || isNaN(idBehavior.parsedData.InstanceID)) {\r\n                        error(`GameObject at \"${prefabType}\":${i} has invalid data in behavior \"${KPrefabIDBehavior}\".`, FAILURE_TYPE.SAVEFILE_CORRUPT);\r\n                        continue;\r\n                    }\r\n\r\n                    normalizedIDs[idBehavior.parsedData.InstanceID] = {\r\n                        type: prefabType,\r\n                        index: i\r\n                    };\r\n                }\r\n            }\r\n\r\n            return {\r\n                ...state,\r\n                isLoading: false,\r\n                saveGame: action.payload.saveGame,\r\n                normalizedIDs\r\n            };\r\n        }\r\n        case ACTION_SAVEFILE_SAVE_START:\r\n            return {\r\n                ...state,\r\n                isSaving: true\r\n            }\r\n        case ACTION_SAVEFILE_SAVE_END:\r\n            return {\r\n                ...state,\r\n                isSaving: false\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n","\r\nimport { AnyAction } from \"redux\";\r\nimport { SaveEditorState, defaultSaveEditorState } from \"./state\";\r\n\r\nimport saveFileReducer from \"./savefile/reducer\";\r\nimport duplicantsReducer from \"./duplicants/reducer\";\r\n\r\n/**\r\n * Flat list of reducers to run against SaveEditorState\r\n * Reducers run in-order.\r\n * \r\n * We do not split into sub-states using combineReducers, since\r\n * these need access to all of the state at this level.\r\n * \r\n * These should be broken into sub-states when we are more normalized.\r\n */\r\nconst reducers = [\r\n    saveFileReducer,\r\n    duplicantsReducer\r\n];\r\n\r\nexport default function saveEditorReducer(state: SaveEditorState = defaultSaveEditorState, action: AnyAction): SaveEditorState {\r\n    for (let reducer of reducers) {\r\n        state = reducer(state, action);\r\n    }\r\n    return state;\r\n}\r\n","\r\nimport { combineReducers } from \"redux\";\r\n\r\nimport saveEditorReducer from \"../services/save-editor/reducer\";\r\nimport { saveEditorStateKey } from \"../services/save-editor/state\";\r\n\r\nconst reducer = combineReducers({\r\n    // TODO: Find a way to satisfy typings with discriminated union actions and combineReducers\r\n    [saveEditorStateKey]: saveEditorReducer as any\r\n});\r\n\r\nexport default reducer;","\r\nimport { applyMiddleware, compose, createStore } from \"redux\";\r\n\r\nimport reducer from \"./reducer\";\r\nimport { AppState, defaultState } from \"./state\";\r\n\r\nimport sagaMiddleware from \"./saga\";\r\n\r\nconst middleware = [\r\n    sagaMiddleware\r\n];\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(reducer, composeEnhancers(\r\n    applyMiddleware(...middleware)\r\n));\r\n\r\nexport default store;\r\n","\r\nimport * as React from \"react\";\r\n\r\nimport {\r\n    NonIdealState,\r\n    Text\r\n} from \"@blueprintjs/core\";\r\n\r\nclass DuplicantsPage extends React.Component {\r\n    render() {\r\n        return (\r\n            <NonIdealState className=\"ui-page ui-page-404\" visual=\"error\">\r\n                <div>\r\n                    <div className=\"ui-title\">I don't know how you got here...</div>\r\n                    <div className=\"ui-title-secondary\">But weasels were probably involved.</div>\r\n                </div>\r\n                <div className=\"ui-body\">\r\n                    <div>No idea what this page is supposed to be, sorry.</div>\r\n                    <div>Try choosing something else to edit.</div>\r\n                </div>\r\n            </NonIdealState>\r\n        )\r\n    }\r\n}\r\n\r\nexport default DuplicantsPage","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport * as React from \"react\";\r\n\r\n\r\ntype Props = {}\r\nclass SkillsPage extends React.Component<Props> {\r\n    render() {\r\n        return (\r\n            <div>Skills (TODO)</div>\r\n        )\r\n    }\r\n}\r\nexport default SkillsPage;","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport * as React from \"react\";\r\n\r\n\r\nimport DuplicantGeneralPageProps from \"./props\";\r\nimport mapStateToProps, { StateProps } from \"./selectors\";\r\n\r\n\r\ntype Props = {}\r\ninterface State {\r\n    editingName: string | null;\r\n}\r\nclass DuplicantGeneralPage extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            editingName: null\r\n        };\r\n    }\r\n    \r\n    componentWillUpdate(nextProps: Props) {\r\n        \r\n    }\r\n\r\n    render() {\r\n        const {\r\n            editingName\r\n        } = this.state;\r\n\r\n        return (\r\n            <div className=\"fill-parent\">\r\n                Appearance (TODO)\r\n            </div>\r\n        );\r\n    }\r\n\r\n    \r\n}\r\nexport default DuplicantGeneralPage;","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport { bindActionCreators } from \"redux\";\r\n\r\nimport { Dispatch } from \"../../../../../../state/utils\";\r\n\r\nimport { renameDuplicant } from \"../../../../../../services/save-editor/duplicants/actions\";\r\n\r\nexport interface DispatchProps {\r\n    renameDuplicant: typeof renameDuplicant;\r\n}\r\n\r\nexport default function mapDispatchToProps(dispatch: Dispatch): DispatchProps {\r\n    return bindActionCreators({\r\n        renameDuplicant\r\n    }, dispatch);\r\n}","\r\nimport { createSelector } from \"reselect\";\r\nimport { createStructuredSelector } from \"../../../../../../state/utils\";\r\n\r\nimport { MinionIdentityBehavior } from \"../../../../../../services/save-editor/behaviors\";\r\nimport { makeGetBehaviorByName } from \"../../../../../../services/save-editor/selectors\";\r\nimport { makeGetDuplicantByID } from \"../../../../../../services/save-editor/duplicants/selectors\";\r\n\r\nimport Props from \"./props\";\r\n\r\nexport interface StateProps {\r\n    identityBehavior: MinionIdentityBehavior | null;\r\n}\r\n\r\nconst mapStateToProps = () => createStructuredSelector<Props, StateProps>({\r\n    identityBehavior: makeGetBehaviorByName(makeGetDuplicantByID<Props>(\"duplicantID\"), MinionIdentityBehavior)\r\n});\r\nexport default mapStateToProps;\r\n","\r\nimport * as React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { autobind } from \"core-decorators\";\r\n\r\nimport {\r\n    EditableText,\r\n    Tabs,\r\n    Tab,\r\n    NonIdealState\r\n} from \"@blueprintjs/core\";\r\n\r\nimport { error, FAILURE_TYPE } from \"../../../../../../logging\";\r\n\r\n\r\nimport DuplicantEditorProps from \"./props\";\r\nimport mapStateToProps, { StateProps } from \"./selectors\";\r\nimport mapDispatchToProps, { DispatchProps } from \"./dispatch\";\r\n\r\n\r\nimport AppearancePage from \"./pages/Appearance\";\r\nimport SkillsPage from \"./pages/Skills\";\r\n\r\n\r\ntype Props = DuplicantEditorProps & StateProps & DispatchProps;\r\ninterface State {\r\n    rename: string | null;\r\n}\r\nclass DuplicantEditor extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            rename: null\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            className,\r\n            identityBehavior\r\n        } = this.props;\r\n\r\n        const {\r\n            rename\r\n        } = this.state;\r\n\r\n        if (!identityBehavior) {\r\n            error(\"Duplicant identity behavior missing\", FAILURE_TYPE.MISSING_BEHAVIOR);\r\n            return (\r\n                <NonIdealState visual=\"error\">\r\n                    Duplicant has no identity behavior.\r\n                </NonIdealState>\r\n            )\r\n        }\r\n        \r\n        const name = rename || identityBehavior.parsedData.name;\r\n        \r\n        return (\r\n            <div className={`ui-duplicant-editor ${className}`}>\r\n                <h1 className=\"ui-title\">\r\n                    <EditableText\r\n                        value={name}\r\n                        onChange={this._onNameChange}\r\n                        onConfirm={this._onRename}\r\n                    />\r\n                </h1> <span className=\"pt-text-muted\">(click to edit)</span>\r\n                <Tabs id=\"DuplicantEditCategories\" className=\"ui-category-tabs layout-item-fill\">\r\n                    <Tab id=\"appearance\" title=\"Appearance\" panel={<AppearancePage />} />\r\n                    <Tab id=\"skills\" title=\"Skills\" panel={<SkillsPage />} />\r\n                </Tabs>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    @autobind()\r\n    private _onNameChange(str: string) {\r\n        this.setState(s => ({\r\n            ...s,\r\n            rename: str\r\n        }));\r\n    }\r\n\r\n    @autobind()\r\n    private _onRename() {\r\n        const name = this.state.rename;\r\n        if (!name) return;\r\n        this.props.renameDuplicant({prefabID: this.props.duplicantID, name});\r\n        this.setState(s => ({\r\n            ...s,\r\n            rename: null\r\n        }));\r\n    }\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DuplicantEditor);","\r\nimport Component from \"./component\";\r\nexport default Component;\r\n","\r\nimport { GameObject } from \"oni-save-parser\";\r\n\r\nimport { createStructuredSelector } from \"../../../../../../state/utils\";\r\n\r\nimport { duplicantsIDs } from \"../../../../../../services/save-editor/duplicants/selectors\";\r\n\r\nexport interface StateProps {\r\n    duplicantsIDs: number[];\r\n}\r\n\r\nconst mapStateToProps = createStructuredSelector<StateProps>({\r\n    duplicantsIDs\r\n});\r\nexport default mapStateToProps;\r\n","\r\nimport { createSelector } from \"reselect\";\r\nimport { createStructuredSelector } from \"../../../../../../state/utils\";\r\n\r\nimport { MinionIdentityBehavior, MinionResumeBehavior } from \"../../../../../../services/save-editor/behaviors\";\r\nimport { makeGetBehaviorByName } from \"../../../../../../services/save-editor/selectors\";\r\nimport { makeGetDuplicantByID } from \"../../../../../../services/save-editor/duplicants/selectors\";\r\n\r\nimport Props from \"./props\";\r\n\r\nexport interface StateProps {\r\n    identityBehavior: MinionIdentityBehavior | null;\r\n    resumeBehavior: MinionResumeBehavior | null;\r\n}\r\n\r\nconst mapStateToProps = () => {\r\n    const duplicant = makeGetDuplicantByID<Props>(\"duplicantID\");\r\n    return createStructuredSelector<Props, StateProps>({\r\n        identityBehavior: makeGetBehaviorByName(duplicant, MinionIdentityBehavior),\r\n        resumeBehavior: makeGetBehaviorByName(duplicant, MinionResumeBehavior)\r\n    })\r\n};\r\nexport default mapStateToProps;\r\n","\r\nimport * as React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { GameObject } from \"oni-save-parser\";\r\n\r\nimport { Card } from \"@blueprintjs/core\";\r\nimport { autobind } from \"core-decorators\";\r\n\r\nimport { error, FAILURE_TYPE } from \"../../../../../../logging\";\r\n\r\n\r\n\r\nimport DuplicantPortraitProps from \"./props\";\r\nimport mapStateToProps, { StateProps } from \"./selectors\";\r\n\r\n\r\ntype Props = DuplicantPortraitProps & StateProps;\r\nclass DuplicantPortrait extends React.Component<Props> {\r\n    render() {\r\n        const {\r\n            className,\r\n            identityBehavior,\r\n            resumeBehavior\r\n        } = this.props;\r\n\r\n        let outerClassName = `ui-duplicant-portrait ${className}`;\r\n\r\n        let name: string;\r\n        let role: string;\r\n\r\n        if (identityBehavior) {\r\n            name = identityBehavior.parsedData.name;\r\n        }\r\n        else {\r\n            error(\"Duplicant not found or identity behavior missing.\", FAILURE_TYPE.MISSING_BEHAVIOR);\r\n            name = \"[IDENTITY MISSING]\";\r\n        }\r\n\r\n        if (resumeBehavior) {\r\n            role = resumeBehavior.parsedData.currentRole\r\n        }\r\n        else {\r\n            error(\"resume behavior missing.\", FAILURE_TYPE.MISSING_BEHAVIOR);\r\n            role = \"[RESUME MISSING]\";\r\n        }\r\n\r\n        return (\r\n            <Card className={outerClassName} interactive={true} onClick={this._onClick}>\r\n                <h5 className=\"ui-duplicant-name\">{name}</h5>\r\n                {/* TODO render a picture.  Plenty of data in identity to do so.  Also see Accessorizer */}\r\n                <div className=\"ui-duplicant-role\">{role}</div>\r\n            </Card>\r\n        );\r\n    }\r\n\r\n    @autobind()\r\n    private _onClick() {\r\n        const {\r\n            duplicantID,\r\n            onClick\r\n        } = this.props;\r\n        if (onClick) onClick(duplicantID);\r\n    }\r\n}\r\nexport default connect(mapStateToProps)(DuplicantPortrait);","\r\nimport Component from \"./component\";\r\nexport default Component;\r\n","\r\nimport * as React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { autobind } from \"core-decorators\";\r\n\r\nimport DuplicantPortrait from \"../DuplicantPortrait\";\r\n\r\n\r\nimport mapStateToProps, { StateProps } from \"./selectors\";\r\n\r\n\r\nexport interface DuplicantsListProps {\r\n    className?: string;\r\n    selectedDuplicantID?: number | null;\r\n    onDuplicantClick?(duplicantID: number): void;\r\n}\r\n\r\ntype Props = DuplicantsListProps & StateProps;\r\nclass DuplicantsList extends React.Component<Props> {\r\n    render() {\r\n        const {\r\n            className,\r\n            duplicantsIDs,\r\n            selectedDuplicantID\r\n        } = this.props;\r\n\r\n        const elements = duplicantsIDs.map(x => <DuplicantPortrait key={x} className={x === selectedDuplicantID ? \"pt-active\" : \"\"} duplicantID={x} onClick={this._onDuplicantClick} />);\r\n\r\n        return (\r\n            <div className={`${className || ''} ui-duplicant-list`}>\r\n                <div className={`fill-parent layout-horizontal layout-wrap container-scroll`}>\r\n                    {elements}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    @autobind()\r\n    private _onDuplicantClick(duplicantID: number) {\r\n        const {\r\n            onDuplicantClick\r\n        } = this.props;\r\n\r\n        if (onDuplicantClick) {\r\n            onDuplicantClick(duplicantID);\r\n        }\r\n    }\r\n}\r\nexport default connect(mapStateToProps)(DuplicantsList);","\r\nimport Component from \"./component\";\r\nexport default Component;\r\n","\r\nimport * as React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { autobind } from \"core-decorators\";\r\n\r\nimport { NonIdealState } from \"@blueprintjs/core\";\r\n\r\n\r\nimport DuplicantsList from \"./components/DuplicantsList\";\r\nimport DuplicantEditor from \"./components/DuplicantEditor\";\r\n\r\n\r\ntype Props = {};\r\ninterface State {\r\n    selectedDuplicantID: number | null;\r\n}\r\nclass DuplicantsPage extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            selectedDuplicantID: null\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            selectedDuplicantID\r\n        } = this.state;\r\n\r\n        let content: React.ReactFragment;\r\n        if (selectedDuplicantID != null) {\r\n            content = <DuplicantEditor className=\"fill-parent\" duplicantID={selectedDuplicantID}/>\r\n        }\r\n        else {\r\n            content = (\r\n                <NonIdealState visual=\"mugshot\">\r\n                    Select a duplicant to edit\r\n                </NonIdealState>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"ui-page ui-page-duplicants fill-parent layout-vertical\">\r\n                <DuplicantsList className=\"layout-item\" selectedDuplicantID={selectedDuplicantID} onDuplicantClick={this._onDuplicantSelected} />\r\n                <div className=\"layout-item-fill\">\r\n                    {content}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    @autobind()\r\n    private _onDuplicantSelected(duplicantID: number) {\r\n        this.setState(s => ({\r\n            ...s,\r\n            selectedDuplicantID: duplicantID\r\n        }));\r\n    }\r\n}\r\n\r\nexport default DuplicantsPage\r\n\r\n","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport * as React from \"react\";\r\nimport { RouteComponentProps, withRouter } from \"react-router\";\r\nimport { Link, LinkProps } from \"react-router-dom\"\r\nimport { autobind } from \"core-decorators\";\r\n\r\nexport interface ActiveAwareLinkProps extends LinkProps {\r\n    exact?: boolean;\r\n}\r\ntype Props = ActiveAwareLinkProps & RouteComponentProps<{}>;\r\nclass ActiveAwareLink extends React.Component<Props> {\r\n    render() {\r\n        const {\r\n            to,\r\n            location,\r\n            children,\r\n            onClick,\r\n            className,\r\n            exact,\r\n\r\n            // Need to strip this out of passed props\r\n            staticContext,\r\n            ...other\r\n        } = this.props\r\n        const pathName = location.pathname;\r\n        let match: boolean;\r\n        \r\n        if (exact) match = to === pathName;\r\n        else match = pathName.startsWith(to.toString());\r\n\r\n        if (match) {\r\n            return <span className={`pt-menu-item pt-active pt-intent-primary ${className || ''}`}>{children}</span>;\r\n        }\r\n\r\n        return <Link to={to} className={`pt-menu-item ${className || ''}`} {...other} onClick={this._onClick}>{children}</Link>;\r\n    }\r\n\r\n    @autobind()\r\n    private _onClick(event: React.MouseEvent<HTMLAnchorElement>) {\r\n        const {\r\n            exact,\r\n            location,\r\n            to,\r\n            onClick\r\n        } = this.props;\r\n        const pathName = location.pathname;\r\n\r\n        let match: boolean;\r\n        if (exact) match = to === pathName;\r\n        else match = pathName.startsWith(to.toString());\r\n\r\n        if (match) {\r\n            event.preventDefault();\r\n            return;\r\n        }\r\n\r\n        if (onClick) {\r\n            onClick(event);\r\n        }\r\n    }\r\n}\r\nexport default withRouter(ActiveAwareLink);","\r\nimport Component from \"./component\";\r\nexport default Component;\r\n","\r\nimport * as React from \"react\";\r\nimport { RouteComponentProps, Switch, Route, Redirect, withRouter } from \"react-router\";\r\n\r\nimport {\r\n    Card,\r\n    Elevation,\r\n    Menu\r\n} from \"@blueprintjs/core\";\r\n\r\nimport ActiveAwareLink from \"../../components/ActiveAwareLink\";\r\n\r\nimport DuplicantsPage from \"./pages/Duplicants\";\r\nimport Error404Page from \"./pages/404\";\r\n\r\n\r\nclass SaveEditorPageComponent extends React.Component {\r\n    render() {\r\n        return (\r\n            <div className=\"ui-page ui-page-saveeditor fill-parent layout-horizontal\">\r\n                <div className=\"ui-nav-menu layout-item\">\r\n                    <ActiveAwareLink to=\"/duplicants\" >Duplicants</ActiveAwareLink>\r\n                    <ActiveAwareLink to=\"/404\" >Not Duplicants</ActiveAwareLink>\r\n                </div>\r\n                <div className=\"layout-item-fill\">\r\n                    <Switch>\r\n                        <Redirect exact from=\"/\" to=\"/duplicants\" />\r\n                        <Route path=\"/duplicants\" component={DuplicantsPage} />\r\n                        <Route exact path=\"/404\" component={Error404Page} />\r\n                        <Redirect to=\"/404\" />\r\n                    </Switch>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SaveEditorPageComponent;","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport * as React from \"react\";\r\n\r\nimport {\r\n    NonIdealState,\r\n    Spinner,\r\n    Text\r\n} from \"@blueprintjs/core\";\r\n\r\nexport default class LoadingSaveFilePageComponent extends React.Component {\r\n    render() {\r\n        return (\r\n            <NonIdealState>\r\n                <Text>Loading File</Text>\r\n                <div>\r\n                    <Spinner large={true}/>\r\n                </div>\r\n                <Text>TODO progress here</Text>\r\n            </NonIdealState>\r\n        );\r\n    }\r\n}","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport { bindActionCreators } from \"redux\";\r\n\r\nimport { Dispatch } from \"../../state/utils\";\r\n\r\nimport { loadSavefile } from \"../../services/save-editor/savefile/actions\";\r\n\r\nexport interface DispatchProps {\r\n    loadSavefile: typeof loadSavefile;\r\n}\r\n\r\nexport default function mapDispatchToProps(dispatch: Dispatch): DispatchProps {\r\n    return bindActionCreators({\r\n        loadSavefile\r\n    }, dispatch);\r\n}","\r\nexport interface StateProps {\r\n\r\n}\r\n\r\nexport default function(): StateProps {\r\n    return {};\r\n}\r\n","\r\nimport * as React from \"react\";\r\n\r\nimport { autobind } from \"core-decorators\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport {\r\n    NonIdealState,\r\n    Button,\r\n    Intent\r\n} from \"@blueprintjs/core\";\r\n\r\n\r\nimport mapStateToProps, { StateProps } from \"./selectors\";\r\nimport mapDispatchToProps, { DispatchProps } from \"./dispatch\";\r\n\r\n\r\nconst saveDescription = \"Oxygen Not Included saves can be found in your documents folder under\";\r\n\r\n// TODO: Show correct path based on user's OS.\r\nconst savePath = \"Klei/OxygenNotIncluded/save_files\";\r\n\r\ntype Props = StateProps & DispatchProps;\r\nclass NoSaveLoadedPageComponent extends React.Component<Props> {\r\n    private _input: HTMLInputElement | null = null;\r\n    \r\n    render() {\r\n        const {\r\n            loadSavefile\r\n        } = this.props;\r\n        return (\r\n            <NonIdealState\r\n                visual=\"floppy-disk\"\r\n                action={\r\n                    <Button intent={Intent.PRIMARY} onClick={this._onLoadClick}>Load a .sav file</Button>\r\n                }\r\n                description=\"No save has been loaded.\"\r\n            >\r\n                <div>{saveDescription} <code>{savePath}</code></div>\r\n                <input\r\n                    ref={el => this._input = el}\r\n                    style={{display: \"none\"}}\r\n                    className=\"pt-button pt-intent-primary\"\r\n                    type=\"file\"\r\n                    accept=\".sav\"\r\n                    onChange={this._onLoadFile}\r\n                />\r\n            </NonIdealState>\r\n        );\r\n    }\r\n\r\n    @autobind()\r\n    private _onLoadClick() {\r\n        if (!this._input) return;\r\n        this._input.click();\r\n    }\r\n\r\n    @autobind()\r\n    private _onLoadFile(change: React.ChangeEvent<HTMLInputElement>) {\r\n        const files = change.target.files;\r\n        if (!files || files.length === 0) return;\r\n        this.props.loadSavefile({file: files[0]});\r\n    }\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NoSaveLoadedPageComponent);","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport { Dispatch } from \"../../state/utils\";\r\n\r\nexport interface DispatchProps { }\r\n\r\nexport default function mapDispatchToProps(dispatch: Dispatch): DispatchProps {\r\n    return {}\r\n}","\r\nimport { createStructuredSelector } from \"../../state/utils\";\r\n\r\nimport {\r\n    loadError\r\n} from \"../../services/save-editor/savefile/selectors\";\r\n\r\n\r\nexport interface StateProps {\r\n    loadError: Error | null;\r\n}\r\n\r\nconst mapStateToProps = createStructuredSelector<StateProps>({\r\n    loadError\r\n});\r\nexport default mapStateToProps;\r\n","\r\nimport * as React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport {\r\n    NonIdealState,\r\n    Text\r\n} from \"@blueprintjs/core\";\r\n\r\n\r\nimport mapStateToProps, { StateProps } from \"./selectors\";\r\nimport mapDispatchToProps, { DispatchProps } from \"./dispatch\";\r\n\r\n\r\ntype Props = StateProps & DispatchProps;\r\nclass ErrorPageComponent extends React.Component<Props> {\r\n    render() {\r\n        let {\r\n            loadError\r\n        } = this.props;\r\n\r\n        if (!loadError) {\r\n            loadError = new Error(\"Well, this is weird... The Error page loaded, but there is no error.\");\r\n            loadError.stack = \"I really don't know what to do about this...\"\r\n        }\r\n\r\n        return (\r\n            <NonIdealState visual=\"error\" description=\"An Error Occurred\">\r\n                <Text>{loadError.message}</Text>\r\n                <div>\r\n                    <code>{loadError.stack}</code>\r\n                </div>\r\n            </NonIdealState>\r\n        );\r\n    }\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ErrorPageComponent);","\r\nimport Component from \"./component\";\r\nexport default Component;","\r\nimport { bindActionCreators } from \"redux\";\r\n\r\nimport { Dispatch } from \"../../state/utils\";\r\n\r\nimport { saveSavefile } from \"../../services/save-editor/savefile/actions\";\r\n\r\nexport interface DispatchProps {\r\n    saveSavefile: typeof saveSavefile;\r\n}\r\n\r\nexport default function mapDispatchToProps(dispatch: Dispatch): DispatchProps {\r\n    return bindActionCreators({\r\n        saveSavefile\r\n    }, dispatch);\r\n}","\r\nimport { createStructuredSelector } from \"../../state/utils\";\r\n\r\nimport {\r\n    saveFileName,\r\n    isSaveChosen,\r\n    isSaveLoading,\r\n    isSaveSaving,\r\n    isSaveEnabled,\r\n    loadError\r\n} from \"../../services/save-editor/savefile/selectors\";\r\n\r\n\r\nexport interface StateProps {\r\n    saveFileName: string | null;\r\n    isSaveChosen: boolean;\r\n    isSaveLoading: boolean;\r\n    isSaveSaving: boolean;\r\n    isSaveEnabled: boolean;\r\n    loadError: Error | null;\r\n}\r\n\r\nconst mapStateToProps = createStructuredSelector<StateProps>({\r\n    saveFileName,\r\n    isSaveChosen,\r\n    isSaveLoading,\r\n    isSaveSaving,\r\n    isSaveEnabled,\r\n    loadError\r\n});\r\nexport default mapStateToProps;\r\n\r\n// Was pretty sure this used to work, once upon a time.\r\n//export type StateProps = typeof mapStateToProps;\r\n","\r\nimport * as React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Route, Redirect, Switch, withRouter } from \"react-router\";\r\nimport { autobind } from \"core-decorators\";\r\n\r\nimport {\r\n    Navbar,\r\n    NavbarGroup,\r\n    NavbarHeading,\r\n    Text,\r\n    Dialog,\r\n    Button,\r\n    Alignment,\r\n    Spinner,\r\n    NonIdealState\r\n} from \"@blueprintjs/core\";\r\n\r\nimport mapStateToProps, { StateProps } from \"./selectors\";\r\nimport mapDispatchToProps, { DispatchProps } from \"./dispatch\";\r\n\r\nimport ErrorPage from \"../../pages/error\";\r\nimport NoSaveLoadedPage from \"../../pages/NoSaveLoaded\";\r\nimport LoadingSaveFilePage from \"../../pages/LoadingSaveFile\";\r\nimport SaveEditorPage from \"../../pages/SaveEditor\";\r\n\r\ntype OwnProps = StateProps & DispatchProps;\r\nclass AppComponent extends React.Component<OwnProps> {\r\n    render() {\r\n        const {\r\n            saveFileName,\r\n            isSaveEnabled,\r\n            isSaveChosen,\r\n            isSaveLoading,\r\n            isSaveSaving,\r\n            loadError\r\n        } = this.props;\r\n\r\n        let rootComponent: React.ComponentType;\r\n        let requireExactPath = true;\r\n\r\n        if (loadError) {\r\n            // Show error screen\r\n            rootComponent = ErrorPage;\r\n        }\r\n        else if (!isSaveChosen) {\r\n            // Show file chooser.\r\n            rootComponent = NoSaveLoadedPage\r\n        }\r\n        else if (isSaveLoading) {\r\n            // Show loading screen.\r\n            rootComponent = LoadingSaveFilePage;\r\n        }\r\n        else {\r\n            // Show editor\r\n            rootComponent = SaveEditorPage;\r\n            requireExactPath = false;\r\n        }\r\n\r\n        return (\r\n            <div className=\"fill-parent layout-vertical pt-dark ui-app-root\">\r\n                <Navbar className=\"layout-item ui-app-navbar\">\r\n                    <NavbarGroup>\r\n                        <NavbarHeading>ONI Save Editor</NavbarHeading>\r\n                        <Text ellipsize={true}>{saveFileName || \"\"}</Text>\r\n                    </NavbarGroup>\r\n                    <NavbarGroup align={Alignment.RIGHT}>\r\n                        <Button icon=\"floppy-disk\" disabled={!isSaveEnabled} onClick={this._onSaveClick}>Save</Button>\r\n                    </NavbarGroup>\r\n                </Navbar>\r\n                <div className=\"layout-item-fill\">\r\n                    <Switch>\r\n                        <Route exact={requireExactPath} path=\"/\" component={rootComponent}/>\r\n                        <Redirect to=\"/\"/>\r\n                    </Switch>\r\n                </div>\r\n                <Dialog isOpen={isSaveSaving} title=\"Saving File\" icon=\"saved\" isCloseButtonShown={false}>\r\n                    <NonIdealState>\r\n                        <div>\r\n                            <Spinner large={true}/>\r\n                        </div>\r\n                        <div>\r\n                            Saving <code>{saveFileName}</code>\r\n                        </div>\r\n                    </NonIdealState>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    @autobind()\r\n    private _onSaveClick() {\r\n        this.props.saveSavefile({});\r\n    }\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AppComponent);","\r\nimport Component from \"./component\";\r\nexport default Component;","\nimport * as React from \"react\";\n\nimport { hot } from \"react-hot-loader\";\nimport { withRouter } from \"react-router\";\n\nimport App from \"./components/App\";\n\n// react-router wants to wrap every element we have in a new element.  Because composability!\n//  without wrapping this in a <Route/> from the outside, the PureComponent hot will not see\n//  any changes, and the broken context system is ignored.\n//  Every other library out their uses an external context store similar to the new react context\n//  pattern, but router just blames everyone else for honoring shouldComponentUpdate and says wontfix.\n// Might be better off removing route altogether and staying a SPA.\nexport default withRouter(hot(module)(App) as any);\n","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"html, body, #root {\\n  height: 100%;\\n  width: 100%; }\\n\\nbody {\\n  margin: 0;\\n  padding: 0; }\\n\\n.fill-parent, .fill-parent-width, .fill-parent-height {\\n  /* Fill parent to our outsides.*/\\n  box-sizing: border-box; }\\n\\n.fill-parent, .fill-parent-width {\\n  width: 100%; }\\n\\n.fill-parent, .fill-parent-height {\\n  height: 100%; }\\n\\n.layout-wrap {\\n  flex-wrap: wrap; }\\n\\n/*\\r\\n============================================================================\\r\\nHorizontal and Vertical Layouts\\r\\n============================================================================\\r\\n*/\\n/* Container for items that can fill up the available space, and optionally be constrained by it. */\\n.layout-vertical {\\n  display: flex;\\n  flex-direction: column; }\\n\\n.layout-horizontal {\\n  display: flex;\\n  flex-direction: row; }\\n\\n.layout-item, .layout-item-fill {\\n  box-sizing: border-box; }\\n\\n.layout-vertical > div, .layout-horizontal > div, .layout-vertical > .layout-item, .layout-horizontal > .layout-item {\\n  flex: none; }\\n\\n.layout-vertical > .layout-item-fill, .layout-horizontal > .layout-item-fill {\\n  flex: 1 1 auto; }\\n\\n.layout-vertical > .layout-item-constrain, .layout-horizontal > .layout-item-constrain {\\n  flex: 0 1 auto; }\\n\\n.layout-vertical > .layout-item-fill, .layout-vertical > .layout-item-constrain {\\n  /* Flex sets min-height to auto, we need to allow it to shrink down */\\n  min-height: 0;\\n  /*\\r\\n    Maintain some sort of inner css specified (vs actual?) value for height, so that \\r\\n    child elements can use height percentages and fill their parent (us)\\r\\n    */\\n  height: 100%; }\\n\\n.layout-horizontal > .layout-item-fill, .layout-horizontal > .layout-item-constrain {\\n  min-width: 0;\\n  width: 100%; }\\n\\n/*\\r\\n============================================================================\\r\\nContent Containers\\r\\n============================================================================\\r\\n*/\\n.container-scroll {\\n  overflow: auto; }\\n\\n/*\\n * Copyright 2017 Palantir Technologies, Inc. All rights reserved.\\n */\\n.ui-app-root {\\n  background-color: #182026; }\\n\\n.pt-navbar.ui-app-navbar {\\n  background-color: #2965cc; }\\n\\n.ui-page.ui-page-404 .ui-title {\\n  font-size: 20pt; }\\n\\n.ui-page.ui-page-404 .ui-title-secondary {\\n  font-size: 12pt; }\\n\\n.ui-page.ui-page-404 .ui-body {\\n  margin-top: 8px; }\\n\\n.ui-page.ui-page-saveeditor .ui-nav-menu {\\n  padding: 15px;\\n  background-color: #394b59; }\\n\\n.ui-page.ui-page-duplicants .ui-duplicant-list {\\n  background-color: #bfccd6;\\n  height: 340px; }\\n  .ui-page.ui-page-duplicants .ui-duplicant-list .ui-duplicant-portrait {\\n    width: 150px;\\n    height: 150px;\\n    margin: 10px;\\n    cursor: pointer; }\\n    .ui-page.ui-page-duplicants .ui-duplicant-list .ui-duplicant-portrait .ui-duplicant-name {\\n      text-align: center; }\\n    .ui-page.ui-page-duplicants .ui-duplicant-list .ui-duplicant-portrait .ui-duplicant-role {\\n      text-align: center; }\\n  .ui-page.ui-page-duplicants .ui-duplicant-list .ui-duplicant-portrait.pt-active {\\n    background-color: #f29d49; }\\n\\n.ui-page.ui-page-duplicants .ui-duplicant-editor {\\n  box-sizing: border-box;\\n  padding: 5px; }\\n  .ui-page.ui-page-duplicants .ui-duplicant-editor .ui-title {\\n    display: inline-block;\\n    width: auto; }\\n\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./root.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./root.scss\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/lib/loader.js!./root.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\r\n import \"@blueprintjs/core/lib/css/blueprint.css\";\r\n import \"@blueprintjs/icons/lib/css/blueprint-icons.css\";\r\n\r\nimport \"./root.scss\";\r\n","\r\nimport * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport { Provider } from \"react-redux\";\r\nimport { HashRouter } from \"react-router-dom\";\r\n\r\nimport \"./css\";\r\n\r\n\r\nimport App from \"./app\";\r\n\r\nimport store from \"./state/store\";\r\n\r\nimport { runSaga } from \"./state/saga\";\r\nrunSaga();\r\n\r\n\r\nconst rootEl = document.getElementById(\"root\");\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <HashRouter>\r\n            <App />\r\n        </HashRouter>\r\n    </Provider>,\r\n    rootEl\r\n);\r\n"],"sourceRoot":""}